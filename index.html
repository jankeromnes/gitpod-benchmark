<!doctype html>
<meta charset="utf-8">
<title>Gitpod vs laptop</title>
<body>
    <canvas id="chart" width="400" height="400"></canvas>
    <pre id="data"></pre>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.3/moment.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-adapter-moment/1.0.0/chartjs-adapter-moment.min.js"></script>
    <script>
        const plot = (data) => {
            const canvas = document.createElement("canvas");
            document.body.appendChild(canvas);
            const ctx = canvas.getContext("2d");
            const chart = new Chart(ctx, {
                type: "line",
                data: {
                    datasets: [{
                        label: "laptop",
                        data: data.datasets.laptop,
                    }, {
                        label: "workspace",
                        borderColor: "#ff8a00",
                        data: data.datasets.workspace,
                    }, {
                        label: "prebuild",
                        borderColor: "#ffb45b",
                        data: data.datasets.prebuild,
                    }],
                },
                options: {
                    parsing: {
                        yAxisKey: "build",
                    },
                    plugins: {
                        title: {
                            display: true,
                            text: data.title,
                        },
                    },
                    scales: {
                        x: {
                            type: "time",
                        },
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: "seconds",
                            },
                        },
                    },
                },
            });
        };

        fetch("./db.json").then(res => res.json()).then(db => {
            document.querySelector("#data").textContent = JSON.stringify(db, null, 4);
            for (const repo in db.repositories) {
                plot(db.repositories[repo]);
            }
        });
    </script>
</body>